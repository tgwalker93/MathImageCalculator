(this.webpackJsonpmern=this.webpackJsonpmern||[]).push([[0],{113:function(e,t){},128:function(e,t,a){},129:function(e,t,a){"use strict";a.r(t);var l=a(0),n=a.n(l),r=a(73),i=a.n(r),o=a(24),s=a(25),c=a(27),u=a(26),m=a(7),h=a(74),d=function(e){return n.a.createElement("div",Object.assign({className:e.size.split(" ").map((function(e){return"col-"+e})).join(" ")},e),e.children)},p=function(e){return n.a.createElement("div",Object.assign({id:e.id,className:"container".concat("true"===e.fluid?"-fluid":"")},e),e.children)},f=function(e){return n.a.createElement("div",Object.assign({className:"row".concat(e.fluid?"-fluid":"")},e),e.children)},g=function(e){return n.a.createElement("div",{className:e.formgroupclass},n.a.createElement("label",{htmlFor:"inputField"},e.label),n.a.createElement("input",Object.assign({className:"form-control",id:"inputField"},e)),"true"===e.isvalid?"":n.a.createElement("span",{className:"help-block"},e.fielderror))},v=function(e){return n.a.createElement("button",Object.assign({},e,{className:"btn btn-pill btn-light btn-lg"}),e.children)},I=a(18),E=a.n(I),A=function(e){return E.a.post("/api/calculator/labelImage",e)},b=function(e){Object(c.a)(l,e);var t=Object(u.a)(l);function l(e){var a;return Object(o.a)(this,l),(a=t.call(this,e)).onFileChange=function(e){a.setState({selectedFile:e.target.files[0]})},a.buttonClicked=function(e){a.setState({lastAPIChoice:e,choiceMade:!0},(function(){}))},a.onFileUpload=function(e){var t;a.state.selectedFile&&((new FormData).append("myFile",a.state.selectedFile,a.state.selectedFile.name),a.getBase64(a.state.selectedFile,(function(l){(t=l).includes("base64")&&"GoogleVision"===e&&(console.log("found base64"),t=l.substring(l.indexOf(",")+1)),a.setState({selectedFileBase64:t,lastAPIChoice:e,uploadButtonClicked:!0},(function(){"MathPix"===e?a.callMathPixAPI():"GoogleVision"===e?a.callGoogleVisionAPI():"WolframAlphaImage"===e&&a.callMathPixAPI()}))})))},a.fileData=function(){return a.state.selectedFile&&"WolframAlphaInput"!==a.state.lastAPIChoice?n.a.createElement("div",null,n.a.createElement("h3",null,"File Details:"),n.a.createElement("p",null,"File Name: ",a.state.selectedFile.name),n.a.createElement("p",null,"File Type: ",a.state.selectedFile.type),n.a.createElement("p",null,"Last Modified:"," ",a.state.selectedFile.lastModifiedDate.toDateString())):"WolframAlphaInput"===a.state.lastAPIChoice?n.a.createElement("div",null):n.a.createElement("div",null,n.a.createElement("h2",null,"Please Upload your Image"),n.a.createElement("input",{id:"chooseFileButton",type:"file",onChange:a.onFileChange}))},a.state={selectedFile:null,selectedFileBase64:"",result:"",lastAPIChoice:"",wolframXMLData:"",wolframSubPods:[],wolframInputFromMathPixReturn:"",choiceMade:!1,uploadButtonClicked:!1,callWolframAlphaAPIComplete:!1,WolframAlphaInputText:"",searchButtonClicked:!1},a}return Object(s.a)(l,[{key:"callWolframAlphaAPIWithTextInput",value:function(){this.setState({searchButtonClicked:!0});for(var e="solve+",t=this.state.WolframAlphaInputText.match(/([\d\w]+)[\s]*[-=+*/]*[\s]*/g),a=0;a<t.length;a++)t[a]=t[a].replace(/=/g,"%3D"),t[a]=t[a].replace(/\s/g,""),e+=t[a];this.callWolframAlphaAPI(e)}},{key:"callWolframAlphaAPI",value:function(e){var t=this;E.a.get("https://cors-anywhere.herokuapp.com/http://api.wolframalpha.com/v2/query?appid=KLVH4J-36KKQUULAH&input="+e,{headers:{"content-type":"application/json","Access-Control-Allow-Origin":"*"}}).then((function(e){t.parseXML(e.data),t.setState({callWolframAlphaAPIComplete:!0})})).catch((function(e){console.log(e)}))}},{key:"parseXML",value:function(e){var t=this;(0,a(98).parseString)(e,(function(e,a){if(console.log(a),"false"===a.queryresult.$.error){for(var l=a.queryresult.pod,n=0;n<l.length;n++)if(l[n].subpod)for(var r=0;r<l[n].subpod.length;r++)if(l[n].subpod[r]&&l[n].subpod[r].img)for(var i=0;i<l[n].subpod[r].img.length;i++)t.state.wolframSubPods.push(l[n].subpod[r].img[i].$)}else t.setState({result:"There was an error in sending this request to WolframAlpha!"})}))}},{key:"callGoogleVisionAPI",value:function(){var e=this,t={imageBase64:this.state.selectedFileBase64};A(t).then((function(t){if(t.data.error)e.setState({result:"There was an error with the image or the server!"});else{console.log("Calling google vision API was successful!"),console.log(t.data);var a="";t.data.responses.length;for(var l=0;l<t.data.responses.length;l++)console.log("i is "+l),a+="Your picture contains a "+t.data.responses[l].labelAnnotations[l].description,console.log(a),a+="\n\n",a+="I am approximately "+parseInt(100*t.data.responses[l].labelAnnotations[l].score)+"% confident of this.\n\n";console.log(a),e.setState({result:a})}}))}},{key:"callMathPixAPI",value:function(){var e=this,t={src:this.state.selectedFileBase64};E.a.post("https://api.mathpix.com/v3/text",t,{headers:{"content-type":"application/json",app_id:"tgwalker93_gmail_com_cc0d50",app_key:"72c390b89e11c4263505"}}).then((function(t){console.log("Post successful"),console.log(t),"WolframAlphaImage"===e.state.lastAPIChoice?e.calculateResultBeforeCallingWolframAlpha(t.data):e.calculateResult(t.data)})).catch((function(e){console.log(e)}))}},{key:"calculateResultBeforeCallingWolframAlpha",value:function(e){if(e.confidence>.9){for(var t="solve+",a=e.text.match(/([\d\w]+)[\s]*[-=+*/]*[\s]*/g),l=0;l<a.length;l++)a[l]=a[l].replace(/=/g,"%3D"),a[l]=a[l].replace(/\s/g,""),t+=a[l];this.callWolframAlphaAPI(t)}else this.setState({result:"I'm sorry I cannot read the image."})}},{key:"calculateResult",value:function(e){if(e.confidence>.9){var t=e.text,a=t.match(/\d+/g);if(console.log(a),t.includes("longdiv")){a=t.match(/(\d\s)+/g);for(var l=0;l<a.length;l++)a[l]=a[l].replace(/\s/g,"");if(2==a.length)return void this.setState({result:a[1]+" divided by "+a[0]+" = "+parseInt(a[1])/parseInt(a[0]),wolframInputFromMathPixReturn:"solve+"+a[1]+"/"+a[0]})}2!==a.length?this.setState({result:"There are two many numbers to calculate!"}):t.includes("times")?this.setState({result:a[0]+" times "+a[1]+" = "+parseInt(a[0])*parseInt(a[1]),wolframInputFromMathPixReturn:"solve+"+a[0]+"*"+a[1]}):t.includes("div")?this.setState({result:a[0]+" divided by "+a[1]+" = "+parseInt(a[0])/parseInt(a[1]),wolframInputFromMathPixReturn:"solve+"+a[0]+"/"+a[1]}):t.includes("-")?this.setState({result:a[0]+" minus "+a[1]+" = "+(parseInt(a[0])-parseInt(a[1])),wolframInputFromMathPixReturn:"solve+"+a[0]+"-"+a[1]}):t.includes("+")&&this.setState({result:a[0]+" plus "+a[1]+" = "+(parseInt(a[0])+parseInt(a[1])),wolframInputFromMathPixReturn:"solve+"+a[0]+"+"+a[1]})}else this.setState({result:"I'm sorry I cannot read the image."})}},{key:"getBase64",value:function(e,t){var a=new FileReader;a.readAsDataURL(e),a.onload=function(){t(a.result)},a.onerror=function(e){console.log("Error: ",e)}}},{key:"reset",value:function(){this.setState({selectedFile:null,selectedFileBase64:"",result:"",lastAPIChoice:"",wolframXMLData:"",wolframSubPods:[],wolframInputFromMathPixReturn:"",choiceMade:!1,uploadButtonClicked:!1,callWolframAlphaAPIComplete:!1,WolframAlphaInputText:"",searchButtonClicked:!1})}},{key:"componentDidMount",value:function(){}},{key:"handleChange",value:function(e){this.setState(Object(h.a)({},e.target.id,e.target.value))}},{key:"render",value:function(){var e=this;return n.a.createElement(p,{id:"mainContainer",fluid:"true"},n.a.createElement(f,{id:"headerRow"},n.a.createElement(d,{size:"sm-12"},n.a.createElement("h1",{style:{textAlign:"center",fontSize:"100px"}},"Math Image Calculator"),this.state.choiceMade?n.a.createElement(v,{id:"resetButton",variant:"primary",onClick:function(){return e.reset()}},"Reset"):"")),n.a.createElement(p,{id:"calculatorContainer",fluid:"true"},n.a.createElement(f,{id:"mainRow"},n.a.createElement(d,{size:"sm-12"},n.a.createElement("div",null,this.state.choiceMade?n.a.createElement("div",null,n.a.createElement("div",{id:"choiceMadeGroup"},"WolframAlphaInput"===this.state.lastAPIChoice?n.a.createElement("div",null,n.a.createElement(g,{label:"Enter your expression or equation!",value:this.state.WolframAlphaInputText,id:"WolframAlphaInputText",onChange:this.handleChange.bind(this),name:"WolframAlphaInputText"}),this.state.searchButtonClicked?n.a.createElement("div",null):n.a.createElement(v,{variant:"primary",onClick:function(){return e.callWolframAlphaAPIWithTextInput()}},"Search")):n.a.createElement("div",null),"MathPix"===this.state.lastAPIChoice&&this.state.selectedFile&&!this.state.callWolframAlphaAPIComplete&&this.state.uploadButtonClicked?n.a.createElement("div",null,n.a.createElement(v,{variant:"primary",onClick:function(){return e.callWolframAlphaAPI(e.state.wolframInputFromMathPixReturn)}},"Show Details")):n.a.createElement("div",null)),n.a.createElement("div",{id:"uploadFileGroup"},this.fileData(),this.state.uploadButtonClicked||"WolframAlphaInput"===this.state.lastAPIChoice?n.a.createElement("div",null):n.a.createElement("div",null,n.a.createElement(v,{variant:"primary",onClick:function(){return e.onFileUpload(e.state.lastAPIChoice)}},"Upload"),n.a.createElement(v,{variant:"primary",onClick:function(){return e.reset()}},"Cancel")))):n.a.createElement("div",null,n.a.createElement("h1",{style:{textAlign:"center"}},"What would you like to do?"),n.a.createElement("div",{id:"buttonGroup"},n.a.createElement(v,{variant:"primary",onClick:function(){return e.buttonClicked("MathPix")}},"Upload Image of Expression"),n.a.createElement(v,{variant:"primary",onClick:function(){return e.buttonClicked("WolframAlphaImage")}},"Upload Image of Equation"),n.a.createElement(v,{variant:"primary",onClick:function(){return e.buttonClicked("GoogleVision")}},"Upload Image to Find Shapes or Labels"),n.a.createElement(v,{variant:"primary",onClick:function(){return e.buttonClicked("WolframAlphaInput")}},"Input Text of Equation or Expression")))),this.state.result?n.a.createElement(p,{id:"resultsContainer",fluid:"true"},n.a.createElement("h1",null,"Results"),n.a.createElement("hr",null),n.a.createElement("h1",null,this.state.result.split("\n").map((function(e,t){return n.a.createElement("div",{key:t},e)}))),this.state.wolframSubPods.map((function(e,t){return n.a.createElement("div",null,n.a.createElement("img",{key:t,src:e.src,alt:e.alt,title:e.title,width:e.width,height:e.height,type:e.type,themes:e.themes,colorinvertable:e.colorinvertable}),n.a.createElement("br",null),n.a.createElement("br",null))}))):""))))}}]),l}(l.Component),C=Object(m.g)(b),y=(a(128),function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(){var e;return Object(o.a)(this,a),(e=t.call(this)).state={},e}return Object(s.a)(a,[{key:"componentDidMount",value:function(){}},{key:"render",value:function(){return n.a.createElement("div",{className:"App"},n.a.createElement("div",null,n.a.createElement(m.b,{exact:!0,path:"/calculator",render:function(){return n.a.createElement(C,null)}}),n.a.createElement(m.b,{exact:!0,path:"/",render:function(){return n.a.createElement(m.a,{to:"/calculator"})}}),n.a.createElement(m.a,{from:"*",to:"/calculator"})))}}]),a}(l.Component)),P=a(16);i.a.render(n.a.createElement(P.a,null,n.a.createElement(m.d,null,n.a.createElement(m.b,{component:y}))),document.getElementById("root"))},77:function(e,t,a){e.exports=a(129)}},[[77,1,2]]]);
//# sourceMappingURL=main.c1cb1b8c.chunk.js.map